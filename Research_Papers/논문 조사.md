# 논문 조사

Complete: Yes
Mandalart: [프로젝트] LG Aimers (https://www.notion.so/LG-Aimers-1751c5ca9b5e8197b2fdf0c8ab115be7?pvs=21)
Period: 2025/02/06

---

# 논문1

### 제목

자궁내 인공수정 시술을 받은 원인불명 난임진단 여성의 임신성공 영향 요인: 배란유도 유형을 중심으로

[www.researchgate.net](https://www.researchgate.net/profile/Mo-Kyung-Sin/publication/281180763_Effect_of_a_Randomized_Controlled_Trial_Walking_Program_on_Walking_Stress_Depressive_Symptoms_and_Cardiovascular_Biomarkers_in_Elderly_Korean_Immigrants/links/5911080f0f7e9bfa06bc7b46/Effect-of-a-Randomized-Controlled-Trial-Walking-Program-on-Walking-Stress-Depressive-Symptoms-and-Cardiovascular-Biomarkers-in-Elderly-Korean-Immigrants.pdf#page=125)

### 자료 분석 방법

- 자궁내 인공수정 시술을 받은 원인불명 난임부부의 연령, 난임치료 특성에 따른 임신 여부의 차이를 X2-test로 분석
- 로지스틱 회귀분석을 이용한 원인 규명

### 연구 결과

**1. 인구학적 특성 및 기본 분포**

- **여성 연령 분포**
    - 연령 그룹별 건수 및 비율:
        - 24세 이하: 약 93건 (0.4%)
        - 25–29세: 약 1,634건 (6.8%)
        - 30–34세: 약 12,198건 (50.4%)
        - 35–39세: 약 8,039건 (33.2%)
        - 40–46세: 약 2,237건 (9.3%)
- **남성(남편) 연령 분포**
    - 연령 그룹별 건수 및 비율:
        - 29세 이하: 약 1.5%
        - 30–35세: 약 30.3%
        - 35–39세: 약 46.0%
        - 40–44세: 약 19.0%
        - 45세 이상: 약 3.2%
    - 평균 연령 비교:
        - 남편 평균: 36.6세 (SD = 4.0)
        - 난임 여성 평균: 34.3세 (SD = 3.7)
        - 연령 차이: 약 2.3년

**2. 난임치료(인공수정) 시술 특성**

- **시술 유형별 분포**
    - 배란유도 시 경구제와 주사제 병용: 70.6% (17,084건)
    - 주사제 단독: 15.8% (3,828건)
    - 배란유도 경구제 단독: 9.8% (2,377건)
    - 자연주기: 3.7% (898건)
- **시술비 지원(인공수정 지원) 횟수**
    - 1회 지원: 49.0% (11,857건)
    - 2회 지원: 33.2% (8,039건)
    - 3회 지원: 17.8% (4,305건)

**3. 임신 성공률(임신 여부) 관련 결과**

- **전체 임신 성공률**
    - 전체 성공률: 11.1%
- **여성 연령대별 임신 성공률**
    - 24세 이하: 15.1%
    - 25–29세: 13.3%
    - 30–34세: 12.7%
    - 35–39세: 9.9%
    - 40–46세: 5.1%
    - **통계검증:** 연령대별 차이에서 통계적으로 유의한 차이(X² = 135.91, p < .001)
- **남성 연령대별 임신 성공률**
    - 29세 이하: 11.5%
    - 30–34세: 11.2%
    - 35–39세: 11.3%
    - 40–44세: 10.1%
    - 45세 이상: 10.9%
    - **통계검증:** 남편 연령별 차이는 유의하지 않음
- **시술 유형별 임신 성공률**
    - 배란유도 시 경구제와 주사제 병용: 12.0%
    - 주사제 단독: 10.0%
    - 배란유도 경구제 단독: 8.3%
    - 자연주기: 7.8%
    - **통계검증:** 차이 유의 (X² = 46.59, p < .001)
- **시술비 지원 차수별 임신 성공률**
    - 1차: 12.0%
    - 2차: 10.6%
    - 3차: 9.8%
    - **통계검증:** 차수에 따른 차이 유의 (X² = 17.70, p < .001)

**4. 임신 성공에 영향을 미치는 요인 (다변량 로지스틱 회귀 분석 결과)**

- **난임 여성의 연령 효과**
    - 교차비(OR): 0.94 (95% CI: 0.92–0.95)
    - 해석: 연령이 1년 증가할 때마다 임신 성공 확률이 약 6% (1/0.94 ≒ 1.06배) 낮아짐
- **시술 유형 효과**
    - 배란유도 시 경구제와 주사제 병용의 경우:
        - 교차비(OR): 1.54 (95% CI: 1.20–1.97)
        - 해석: 자연주기 대비 1.54배 높은 임신 성공률
- **인공수정 시술비 지원 차수 효과**
    - 교차비(OR): 0.86 (95% CI: 0.82–0.91)
    - 해석: 지원 차수가 늘어날수록(즉, 1차에서 2차, 2차에서 3차) 임신 성공 확률이 감소

**5. 5년 후 임신 성공률 변화에 따른 비교 분석 (Table 4 관련)**

- **난임 여성 연령에 따른 5년 후 임신 성공률 감소**
    - 24세 미만: 11.9% 감소
    - 25–29세: 4.5% 감소
    - 30–34세: 22.0% 감소
    - 35–39세: 48.5% 감소
- **시술방법(치료 유형)에 따른 임신 성공률 변화**
    - 자연주기 대비:
        - 주사제 사용: 28.2% 증가
        - 경구제 사용: 6.4% 증가
        - 경구제와 주사제 병용: 53.8% 증가
    - 추가 비교:
        - 주사제 단독 또는 경구제 단독 대비 병용 시 각각 20.0%, 44.6% 더 높은 임신 성공률
- **시술비 지원 차수에 따른 변화**
    - 1차에서 실패 후 2차 지원 시: 임신 성공률 11.7% 감소
    - 2차에서 3차 지원 시: 임신 성공률 7.5% 감소

**6. 통계적 검증 및 모델 관련 확인 사항**

- 각 비교군에 대해 사용된 통계치(예: Chi-square 값, p-값 등)의 최신 데이터 내 유의성 여부
- 다변량 로지스틱 회귀 분석 시 사용된 변수(연속형, 범주형 변수 처리 방식) 및 교차비(OR)와 95% 신뢰구간
- 원본 연구와 최신 데이터 간 표본 크기, 모집단 특성, 연구 기간 및 치료 프로토콜의 변경 여부

**7. 정리**

- **여성 연령:** 가장 중요한 변수로, 연령 증가에 따른 임신 성공률 감소(OR 0.94 per year)를 반영.
- **치료(시술) 방법:** 자연주기, 경구제 단독, 주사제 단독, 경구제와 주사제 병용 등의 방법 중 병용법이 가장 효과적임.
- **치료 주기(시술 차수):** 주기 증가에 따른 성공률 감소 패턴.
- **진단의 정확성:** 남성 난임 관련 검사 결과 등 추가 임상 정보의 확보 여부.
- **추가 변수 고려:** 정서적 요인, 신체적 상태, 사회경제적 요인 등.

---

# 논문2

### 제목

산부인과 전문병원 내원환자의 난임 특성과 보조생식술 유형이 임신에 미치는 영향

[www.kais99.org](https://www.kais99.org/jkais/journal/Vol17No8/p38/cr/cr.pdf)

### 자료 분석 방법

- 분석방법은 교차분석, 로지스틱 회귀분석 사용
- 통계적 검정은 χ2-test를 사용

### 연구 결과

난임 대상자 특성은 30대(72.1%)가 가장 많았고, 질병은 없는 경우(70.9%), 출산 자녀도 없음(77.0%)이 가장 많았다. 난임 원인은 **연령이 높을수록** 자궁요인이 많았고, 연령이 낮을수록 **난소 요인**이 많았다. 보조생식술을 시행한 시술은 IUI(51.5%), IVF(23.0%), IUI+IVF(25.6%) 이었고, 보조생식술 시술은 연령(p<.013), 난임 기간(p<.014), 유산경험(p<.008)이 통계적으로 유의하였다. 보조생식술 시술 결과 임신이 34.9%이었고, 그 중 인공수정은 49.2%, 체외수정은 50.8% 이었다. 성공 시술 평균 횟수는 인공수정 시술은 1.64회, 체외수정 시술은 1.36회로 체외수정이 인공수정보다 0.28회 낮았다. 따라서 보조생식술 유형에 따른 임신 성공률을 높이기 위해서는 인공수정 시술은 **연령이 낮고, 난임 기간이 짧을수록, 출산 자녀가 없는 경우**, 체외수정 시술은
연령이 높고, 난임 기간이 길수록, 출산 자녀가 있는 경우 선택해야 한다

### 제안

`챗gpt`

1. **데이터 준비 및 전처리**

- **입력 변수(Feature) 선정**
    - **기본 인구통계 및 임상 정보:**
        - 연령, 난임 기간, 난임 인지 기간(난임 인지 여부 및 기간)
        - 출산 자녀 수(일차성/이차성 난임 여부)
        - 피임 및 유산 경험
        - 기존 질병 여부
    - **수술/치료 이력 및 보조생식술 관련 정보:**
        - 보조생식술(ART) 유형: 인공수정, 체외수정, 두 가지 모두
        - 정부 지원 여부 및 지원 횟수
        - 치료(시술) 횟수, 주기별 성공률 정보
    - **난임 원인 및 관련 요인:**
        - 자궁, 난소, 난관 등 난임 원인 분류
        - 대상자의 연령대에 따른 원인 분포(예, 40세 이상은 자궁 요인, 35-39세에서 난소 요인 등)
- **데이터 정제 및 인코딩**
    - 누락값 처리, 이상치 제거
    - 범주형 변수(예, ART 유형, 질병 유무 등)는 One-Hot 인코딩 또는 Label Encoding
    - 연속형 변수(연령, 난임 기간 등)는 필요에 따라 표준화 또는 정규화

2. **탐색적 데이터 분석 (EDA) 및 변수 관계 파악**

- **교차분석 및 단변량/이변량 분석**
    - 연구에서는 χ²-test를 이용하여 대상자의 일반적 특성, 난임 요인, 시술 행태와 치료 결과 간의 유의성을 검증하였으므로,
        - 각 범주형 변수(연령대, 난임 기간, 보조생식술 유형, 출산 자녀 수 등)와 임신 성공률 간의 관계를 먼저 탐색
        - 예를 들어, “30-34세”에서 임신 성공률이 가장 높고 “40세 이상”에서 낮은 점, 난임 기간이 길수록 성공률이 감소하는 패턴 확인
- **시각화 및 상관관계 분석**
    - 변수 간 상관관계를 heatmap, 박스플롯 등으로 시각화하여 주요 예측 변수를 도출
    - 특히, 연구 결과에서 통계적으로 유의한 변수(연령, 난임 기간, 치료 시술 행태 등)를 우선 후보로 선정

3. **모델 선택 및 구축**

- **기본 모델: 로지스틱 회귀 (Logistic Regression)**
    - 연구에서는 로지스틱 회귀분석을 사용해 각 변수(예: 연령, 난임 기간, 보조생식술 유형 등)가 임신 성공에 미치는 영향을 평가
    - 로지스틱 회귀는 결과 해석(예: 교차비, OR 및 신뢰구간 제공)이 용이하여 임상적 해석에 유리함
- **추가적인 머신러닝 모델 고려**
    - 데이터의 특성과 변수의 상호작용이 복잡할 경우, 결정 트리, 랜덤 포레스트, Gradient Boosting, 심지어 신경망 등 비선형 모델을 고려할 수 있음
    - 여러 모델을 비교 평가하여 최적의 성능과 해석 가능성 사이에서 균형을 맞춤
- **변수 선택 및 특성 공학 (Feature Engineering)**
    - 연구에서 유의미하게 나타난 변수들(연령, 난임 기간, ART 유형, 출산 이력 등)을 중심으로 특성을 재구성
    - 예를 들어, “연령과 난임 기간의 상호작용” 또는 “수술/치료 횟수에 따른 누적 효과”와 같이 변수 간 상호작용 항을 추가
    - 변수 선택 기법(예, Lasso, stepwise selection 등)을 활용하여 불필요한 변수를 제거

4. **모델 평가 및 검증**

- **평가 지표 설정**
    - 결과 변수가 출산(임신) 성공 여부와 같이 이진 분류이므로, 정확도(Accuracy), 민감도(Recall), 특이도(Specificity), F1-score, ROC-AUC 등의 지표를 활용하여 평가
- **교차 검증 (Cross-Validation)**
    - 데이터셋이 제한적일 경우, k-fold 교차검증을 통해 모델의 일반화 성능을 확보
- **해석 가능성**
    - 로지스틱 회귀의 경우, 각 변수의 회귀 계수를 통해 임신 성공에 미치는 영향(예, OR)을 해석
    - 머신러닝 모델의 경우, SHAP 값이나 feature importance를 활용해 변수 영향력을 평가

5. **연구 결과와 정책적/임상적 함의 반영**

- **연령과 난임 기간**
    - 연구 결과에서 연령이 높을수록, 난임 기간이 길수록 임신 성공률이 낮은 것으로 나타남
    - 따라서, 모델에서는 이 두 변수를 중요한 예측 변수로 반영하고, 비선형 효과(예, 30-34세와 40세 이상 간의 차이 등)를 고려할 필요
- **보조생식술 유형 및 시술 횟수**
    - 인공수정, 체외수정, 두 가지 모두 시술한 경우 각각의 성공률 및 평균 시술 횟수 차이를 반영
    - 정부 지원 여부, 치료 주기 등도 추가 변수로 고려하여, 경제적/정책적 요인이 임신 성공률에 미치는 영향을 분석
- **난임 원인(자궁, 난소, 난관 등)**
    - 대상자의 난임 원인에 따른 시술 방법의 선택 및 성공률 차이를 모델에 반영
    - 특정 원인에 따라 최적의 치료 방법이 달라질 수 있으므로, 이를 입력 변수로 추가

```python
//claude 3.5
import pandas as pd
import numpy as np
from sklearn.model_selection import train_test_split
from sklearn.preprocessing import StandardScaler
from sklearn.linear_model import LogisticRegression
from sklearn.metrics import classification_report
from sklearn.ensemble import RandomForestClassifier

def preprocess_fertility_data(df):
    """
    임신 예측을 위한 데이터 전처리 함수
    """
    # 연령 그룹 인코딩
    age_mapping = {
        '30세미만': 0,
        '30-34세': 1,
        '35-39세': 2,
        '40세이상': 3
    }

    # 난임 기간 인코딩
    duration_mapping = {
        '1년이하': 0,
        '1-2년': 1,
        '2-3년': 2,
        '3년이상': 3
    }

    # 질병 여부 인코딩
    disease_mapping = {
        '없음': 0,
        '있음': 1
    }

    # 난임 원인 인코딩
    cause_mapping = {
        '자궁요인': 0,
        '난관요인': 1,
        '난소요인': 2,
        '기타': 3
    }

    # 시술 종류 인코딩
    treatment_mapping = {
        '인공수정': 0,
        '체외수정': 1,
        '모두': 2
    }

    return df

def create_fertility_model():
    """
    임신 예측을 위한 머신러닝 모델 생성
    """
    # Random Forest 모델 사용 (논문의 로지스틱 회귀분석 결과를 참고하여 확장)
    model = RandomForestClassifier(
        n_estimators=100,
        max_depth=5,
        random_state=42
    )

    return model

def evaluate_model(model, X_test, y_test):
    """
    모델 성능 평가
    """
    predictions = model.predict(X_test)
    print(classification_report(y_test, predictions))

    # 특성 중요도 출력
    feature_importance = pd.DataFrame({
        'feature': X_test.columns,
        'importance': model.feature_importances_
    }).sort_values('importance', ascending=False)

    return feature_importance

# 예측에 사용할 주요 특성들
FEATURES = [
    'age_group',           # 연령대
    'infertility_duration',# 난임 기간
    'disease_status',      # 질병 여부
    'infertility_cause',   # 난임 원인
    'treatment_type',      # 시술 종류
    'previous_births',     # 이전 출산 여부
    'previous_miscarriage',# 유산 경험
    'treatment_count'      # 시술 횟수
]

```

연구 내용을 바탕으로 다음과 같은 접근 방식을 제안합니다:

1. 주요 예측 변수 선정:
- 연령 (논문에서 가장 중요한 예측 변수로 확인)
- 난임 기간 (3년 이상 vs 미만)
- 난임 원인 (자궁요인, 난관요인, 난소요인 등)
- 시술 종류 (인공수정 vs 체외수정)
- 질병 여부
- 이전 출산 경력
- 유산 경험
- 시술 횟수
1. 모델링 접근 방식:
- 기본적으로 로지스틱 회귀분석을 사용 (논문에서 사용한 방식)
- Random Forest 분류기를 추가로 사용하여 성능 비교
- 교차 검증을 통한 모델 검증
1. 특별 고려사항:
- 연령대별 차등적 가중치 적용 (30-34세가 가장 높은 성공률)
- 시술 종류에 따른 차별화된 예측 (인공수정 vs 체외수정)
- 난임 원인별 성공률 차이 반영
1. 성능 평가:
- ROC 커브와 AUC 스코어
- 정확도, 민감도, 특이도 평가
- 교차 검증을 통한 모델 안정성 검증
1. 한계점 및 추가 고려사항:
- 병원별 데이터 차이 고려
- 시간에 따른 시술 기술 발전 반영
- 환자의 생활습관, 스트레스 등 추가 변수 수집 필요

---

[repository.kihasa.re.kr](https://repository.kihasa.re.kr/bitstream/201002/10743/1/%EB%B3%B4%EA%B1%B4%EC%82%AC%ED%9A%8C%EC%97%B0%EA%B5%AC.2013.V033.N03_07.pdf)

일반적으로 `인공수정`을 3~4회 시행해도 임신이 안 되는 경우 `체외수정`을 시행한다. 체외수정 시술의 주기당 지속 임신율은 15~20%이며, 누적임신율은 체외수정술을 3~5회 시행할 경우 50~70%로 보고되고 있다. 체외수정 시술을 반복적으로 시행하는 경우에 3∼6회까지는 성공률에 큰 차이가 없으며, 35세 이하의 여성의 약 50%는 체외수정시술 5회 이내에 임신을 하게 된다(구병삼 외, 2001).

---

[](https://www-dbpia-co-kr-ssl.openlink.ssu.ac.kr/journal/articleDetail?nodeId=NODE11920794)

분석 결과 ‘연령’에 있어서 <0.001로 임신 여부 에 따라 통계적으로 유의한 차이를 보였다. 임신한 대상자의 `평균 나이`는 32.9±4.8세로 임신하지 않은 대상자의 평균 나이 37.3±4.7세보다 낮았다. 또한 ‘`체외수정 횟수`’도 p값이 0.020으로 얻어져 통계적 으로 유의한 차이를 보였다. ‘비임신’한 경우 평균 체외수정 횟수가 1.7±2.5회로 ‘임신’한 경우의 0.5±1.4회 보다 높게 나타났다. 즉, 경험한 체외수정 횟수가 적을수록 임신할 확률이 높아진 것으로 나타 났다. 나머지 변수들에 대해서는 임신 여부별로 유의 수준 0.05 하에서 통계적으로 유의한 차이를 보이지 않았다.

---

### 임신율에 영향을 미치는 주요 요인

**배란 유도 치료 유형:**

배란 유도 치료의 종류는 임신율에 상당한 영향을 미칩니다. Gonadotropin 치료는 다른 방법에 비해 더 높은 성공률과 관련이 있는 것으로 나타났습니다([Dar et al., 2024](https://typeset.io/papers/factors-affecting-pregnancy-and-live-birth-rates-in-3zaknwn5fl); [Yao et al., 2023](https://typeset.io/papers/factors-influencing-the-pregnancy-outcome-of-intrauterine-2yw2702g)). 예를 들어, gonadotropin과 함께 letrozole을 사용하는 경우 개선된 결과가 나타났습니다([Yao et al., 2023](https://typeset.io/papers/factors-influencing-the-pregnancy-outcome-of-intrauterine-2yw2702g)).

**여성의 나이:**

젊은 여성(30세 이하)은 노년 여성보다 임신율이 높습니다([Li et al., 2024](https://typeset.io/papers/analysis-of-influencing-factors-of-clinical-pregnancy-rate-6x01gz6t8vir)). 나이가 증가할수록 임신 가능성이 감소하므로, 치료 계획 수립 시 나이의 중요성이 강조됩니다([Jang et al., 2015](https://typeset.io/papers/factors-affecting-the-pregnancy-rate-of-intra-uterine-1t0ix2etkt)).

**호르몬 수치 및 자궁내막 관련 요인:**

기본 호르몬 수치, 특히 에스트라디올(E2) 수치와 자궁내막 두께는 매우 중요합니다. 높은 AMH 수치와 최적의 자궁내막 두께(8-12mm)는 더 나은 임신 결과와 상관관계가 있습니다([Yao et al., 2023](https://typeset.io/papers/factors-influencing-the-pregnancy-outcome-of-intrauterine-2yw2702g); J[ain & Chittawar, 2023](https://typeset.io/papers/predictive-factors-for-pregnancy-in-intrauterine-2t5zn5pb)).

---

### 제공된 연구 결과와 코드를 바탕으로 ExtraTrees 모델을 발전시키기 위한 단계별 개선 방안을 제안

1. 데이터 전처리 개선:
    - 연령대 구간화 (30-34세를 기준으로 구간 설정)
    - 결측치 처리 방법 개선 (현재는 단순 0으로 대체)
    - 시술 횟수 관련 변수들의 비율화 (성공/실패 비율 등)
    - 체외수정과 인공수정 시술의 가중치 차등 적용
2. 피처 엔지니어링:
    - 연령과 시술 유형의 상호작용 변수 생성
    - 난임 기간과 시술 횟수의 복합 지표 생성
    - 호르몬 수치와 자궁내막 관련 변수들의 정규화
    - 시술 간격에 대한 새로운 피처 생성
3. 모델 앙상블 구현:
    - ExtraTrees와 다른 모델(XGBoost, LightGBM)의 앙상블
    - 연령대별 특화 모델 구축 후 결합
    - 시술 유형별(IUI vs IVF) 개별 모델 구축
4. 하이퍼파라미터 최적화:
    - n_estimators: 더 많은 트리 생성 (현재 기본값 사용)
    - max_depth: 연령대별 특성 반영
    - min_samples_split: 데이터 특성에 맞게 조정
    - class_weight: 불균형 데이터 처리
5. 검증 전략 개선:
    - 시계열 기반 교차 검증 도입
    - 연령대별 층화 샘플링 적용
    - 다중 평가 지표 도입 (AUC, F1-score, precision, recall)
6. 새로운 피처 추가 고려:
    - 배란 유도 치료 유형 세분화
    - 호르몬 수치 관련 변수
    - 자궁내막 상태 지표
    - 생활습관 관련 변수 (가능한 경우)

이러한 개선사항들을 단계적으로 적용하여 모델의 예측 성능을 향상시킬 수 있을 것입니다. 특히 연령과 시술 유형에 따른 차별화된 접근이 중요할 것으로 보입니다.